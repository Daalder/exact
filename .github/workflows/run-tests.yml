name: run-tests

on: [push, pull_request]
env:
    COMPOSER_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    DB_DATABASE: unit_tests
jobs:
    tests:
        runs-on: ${{ matrix.os }}
        strategy:
            fail-fast: true
            matrix:
                os: [ubuntu-latest]
                php: [7.4]
                laravel: [8.*]
                dependency-version: [prefer-stable]
                include:
                    -   laravel: 8.*
                        testbench: 6.*

        name: P${{ matrix.php }} - L${{ matrix.laravel }} - ${{ matrix.dependency-version }}
        steps:
            - id: foo
              uses: Daalder/run-tests-action@1.2.4
              env:
                  GITHUB_TOKEN: ${{ github.token }}
                  PACKAGIST_TOKEN: ${{ secrets.DAALDER }}
                  SLACK_BEARER_TOKEN: ${{ secrets.SLACK_BEARER_TOKEN }}
